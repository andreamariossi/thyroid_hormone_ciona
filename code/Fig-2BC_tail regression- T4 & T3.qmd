---
title: "Fig-2 tail retaction t4"
format: html
engine: knitr
editor: visual
grid: 
  sidebar-width: 100px
  body-width: 2000px
  margin-width: 100px
  gutter-width: 3.5rem
execute:
  fig-align: center
  fig-format: svg
---

## Tail regression: T4 & T3

```{r}
rm(list = ls())
knitr::opts_chunk$set(
  echo = TRUE,
  fig.width = 18,
  fig.height = 10,
  fig.align = "center",
  out.width = "70%",
  column = "page"
)

# Package loading
suppressPackageStartupMessages({
  # Data manipulation & file import
  library(tidyverse)
  library(readxl)
  library(paletteer)
  library(rstatix)
  library(ggpubr)
  library(knitr)
  library(Cairo)
  library(lme4)
  library(lmerTest)
  library(emmeans)
  library(kableExtra)
  library(patchwork)
  })

```

## Data Loading and Preprocessing

```{r}
# ===== path =====
file_path <- "/Users/andrea/Princeton Dropbox/Andrea Mariossi/4.paper_archive/2025_thyroid_pathway_&_metamorphosis/3.1.ScienceAdvances_submission_rev/tables/"

# ===== theme & style =====
custom_theme <- function() {
  theme(
    axis.ticks = element_line(linewidth = 0.5),
    axis.ticks.length = unit(0.09, "cm"),
    legend.key.height = unit(20, "pt"),
    axis.line = element_blank(),
    panel.border = element_rect(colour = "black", fill = NA, linewidth = 1),
    panel.background = element_blank(),
    plot.background = element_blank(),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    legend.background = element_blank(),
    legend.box.background = element_blank(),
    legend.key = element_blank(),
    strip.background = element_blank(),
  )
}

# ===== set theme =====
theme_set(theme_pubr(base_size = 13,
                     base_family = "Helvetica") + custom_theme())

# ===== extra bits =====
no_legend <- theme(legend.position = "none")
axis_text_45 <- theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1))

# ===== color palette =====
contPalette <- paletteer_c("ggthemes::Red-Green-Gold Diverging", 30)

stage_order <- c("earTII", "midTII", "latTII", "latTIII", "larva")

# ===== pretty p-values for kable =====
format_pvalues <- function(df) {
  df %>%
    mutate(across(any_of(c("p.value", "p.value.x", "p.value.y", "adj.p.value")), 
                  ~ case_when(
                    . < 0.001 ~ format(., scientific = TRUE, digits = 2),
                    TRUE ~ as.character(round(., 4))
                  )))
}
```

```{r}
speedTail <- read_excel(paste0(file_path,"5_tail_retraction_T4_T3.xlsx"))

# speedTail <- read_excel(paste0(file_path,"Desktop/table_submission.xlsx"), 
#                           sheet = "tail_retraction_T4_T3") 

colnames(speedTail) <- tolower(colnames(speedTail))

# __________________________________________________________________________
# quick plot. + stat

# Define  levels and comparisons
treatment_levels <- c('Control', '70nM', '140nM', '600nM')
control_comparisons <- list(c("Control", "70nM"),
                            c("Control", "140nM"),
                            c("Control", "600nM"))

# Corrected processing function
process_timepoint <- function(data, suffix) {
  selected_cols <- data %>% dplyr::select(ends_with(suffix))
  renamed_cols <- selected_cols %>% rename_with(~str_remove(., paste0("_", suffix)))
  renamed_cols %>%
    drop_na() %>%
    dplyr::group_by(group_treatment, replicate) %>%
    dplyr::summarise(across(where(is.numeric), mean, na.rm = TRUE), .groups = "drop") %>%
    mutate(group_treatment = factor(group_treatment, levels = treatment_levels))
}

# Process each timepoint separately 
T4_6hpf <- process_timepoint(speedTail, "a")
T4_8hpf <- process_timepoint(speedTail, "b")
T4_24hpf <- process_timepoint(speedTail, "c")
T3_8hpf <- process_timepoint(speedTail, "d")

T4_6hpf |> glimpse()
T3_8hpf |> glimpse()
```

## Descriptive info

```{r}

# Total larvae across all experiments
speedTail |>
  summarise(
    n_total = sum(!is.na(length_a)) +
      sum(!is.na(length_b)) +
      sum(!is.na(length_c)) +
      sum(!is.na(length_d))
  )

speedTail_long <- speedTail |>
  pivot_longer(
    cols = c(experiment_a, replicate_a, group_treatment_a, length_a,
             experiment_b, replicate_b, group_treatment_b, length_b,
             experiment_c, replicate_c, group_treatment_c, length_c,
             experiment_d, replicate_d, group_treatment_d, length_d),
    names_to = c(".value", "set"),
    names_pattern = "(experiment|replicate|group_treatment|length)_([a-d])"
  )

## larva numbers: replicate x experiment
speedTail_long |>
  filter(!is.na(length)) |>
  count(experiment, group_treatment, replicate, name = "n_individuals")

## larva numbers: experiment
speedTail_long |>
  filter(!is.na(length)) |>
  summarise(n_individuals = n(), .by = c(experiment, group_treatment))

## count replicates numbers
speedTail_long |>
  filter(!is.na(length)) |>
  summarise(n_individuals = n(), .by = experiment)

#------ labels for plot ------

# n labels for sets _a,_b, _c, _d
n_a <- speedTail_long %>%
  filter(set == "a", !is.na(length)) %>%
  count(group_treatment) %>%
  mutate(label = paste0("n=", n), y = 130)

n_b <- speedTail_long %>%
  filter(set == "b", !is.na(length)) %>%
  count(group_treatment) %>%
  mutate(label = paste0("n=", n), y = 130)

n_c <- speedTail_long %>%
  filter(set == "c", !is.na(length)) %>%
  count(group_treatment) %>%
  mutate(label = paste0("n=", n), y = 130)

n_d <- speedTail_long %>%
  filter(set == "d", !is.na(length)) %>%
  count(group_treatment) %>%
  mutate(label = paste0("n=", n), y = 130)
```

## stat analysis

```{r}

# -------------------------------------
# stat_analysis: anova over +/- drug
# ------------------------------------- 

# moving to tidyverse and map 
timepoint_list <- list(T4_6hpf, T4_8hpf, T4_24hpf, T3_8hpf)
names(timepoint_list) <- c("T4_6hpf", "T4_8hpf", "T4_24hpf", "T3_8hpf")

stat_results <- map(timepoint_list, ~{
  list(
    anova = aov(length ~ group_treatment, data = .x),
    tukey = TukeyHSD(aov(length ~ group_treatment, data = .x)),
    cohens_d = cohens_d(.x, length ~ group_treatment)
  )
})

stat_results$T4_6hpf$anova
stat_results$T4_6hpf$tukey
stat_results$T4_6hpf$cohens_d

stat_results$T4_8hpf$anova
stat_results$T4_8hpf$tukey
stat_results$T4_8hpf$cohens_d

stat_results$T4_24hpf$anova
stat_results$T4_24hpf$tukey
stat_results$T4_24hpf$cohens_d


### i could have use purr map + imap for plot as well.
# Apply the function to each time point ++>output is a list
# timepoints <- c("a", "b", "c", "d") # Corresponding to 6hpf, 8hpf, 24hpf, T3_8hpf
# processed_data <- map(set_names(timepoints), ~process_timepoint(speedTail, .x)) %>%
#   set_names(c("T4_6hpf", "T4_8hpf", "T4_24hpf", "T3_8hpf"))
# stat_results <- map(processed_data, stat_analysis)
# plots <- imap(processed_data, ~create_plot(.x, paste("Timepoint:", str_remove(.y, "a"))))
# ggarrange(plotlist = plots, ncol = 2, nrow = 2)




```

## quick visualisation

```{r}
#| fig-width: 16
#| fig-height: 10
#| out-width: 100%

# -------------------------------------
# quick assesment plot
# ------------------------------------- 
# Just using ANOVA and Tukey's test to compare the control group with all drug []

create_plot <- function(data, title) {
  # Calculate Tukey results
  tukey_res <- aov(length ~ group_treatment, data) %>% 
    TukeyHSD() %$%
    group_treatment %>%
    as.data.frame() %>%
    filter(grepl("Control", rownames(.))) %>%
    mutate(
      comparison = str_remove(rownames(.), "-Control"),
      p.signif = case_when(
        `p adj` < 0.001 ~ "***",
        `p adj` < 0.01 ~ "**",
        `p adj` < 0.05 ~ "*",
        TRUE ~ "ns"
      )
    )
  
  # Calculate y-axis limits
  y_max <- max(data$length)
  y_range <- y_max - min(data$length)
  y_start <- y_max + (0.1 * y_range)
  step <- 0.08 * y_range
  
  # simple plot
  p <- ggplot(data, aes(x = factor(group_treatment, levels = treatment_levels), 
                       y = length, 
                       fill = group_treatment)) +
    geom_boxplot(width = 0.6, alpha = 0.7) +
    geom_jitter(width = 0.1, size = 2, shape = 21) +
    scale_fill_brewer(palette = "Set2") +
    labs(title = title, x = "", y = "% tail regression") +
    custom_theme() +
    theme(legend.position = "none",
          plot.title = element_text(hjust = 0.5, face = "bold")) +
    # Expand top margin for significance markers
    scale_y_continuous(expand = expansion(mult = c(0.05, 0.15))) 
  
  # Statistical comparisons 
  for(i in 1:nrow(tukey_res)) {
    p <- p + geom_signif(
      comparisons = list(c("Control", tukey_res$comparison[i])),
      annotations = tukey_res$p.signif[i],
      y_position = y_start + (i-1)*step,
      tip_length = 0.01,
      vjust = 0.5,  # Center text vertically
      textsize = 4
    )
  }
  
  return(p)
}

plot_6hpf <- create_plot(T4_6hpf, "T4 - 6 hpf")
plot_8hpf <- create_plot(T4_8hpf, "T4 - 8 hpf") 
plot_24hpf <- create_plot(T4_24hpf, "T4 - 24 hpf")
plot_T3 <- create_plot(T3_8hpf, "T3 - 8 hpf")

# Arrange plots
plot_6hpf + plot_8hpf + plot_24hpf + plot_T3 + plot_layout(guides = "collect") & theme(legend.position = 'bottom')

```

Panel paper

```{r }
#| fig-width: 12
#| fig-height: 7
#| out-width: 100%
# _____________________________________________________________________
# Plot with significance bars
# _____________________________________________________________________

# geom_signif that I used in the upper cell works okay if I don’t reverse the y-axis; when I do, it fails, and honestly it’s just faster to add the line manually than to troubleshoot it.

# colors
custom_colors_T4 <- c("Control" = "#bdd7e7", "70nM" = "#6baed6", "140nM" = "#2171b5", "600nM" = "#1a56a6")
custom_colors_T3 <- c("Control" = "#e6d7ef", "70nM" = "#c9a8e0", "140nM" = "#a579d1", "600nM" = "#7b52b5")

# Function to get statistics
get_stats <- function(data) {
  aov_res <- aov(length ~ group_treatment, data = data)
  tukey_res <- TukeyHSD(aov_res)$group_treatment %>%
    as.data.frame() %>%
    tibble::rownames_to_column("comparison_full") %>%
    filter(grepl("Control", comparison_full)) %>%
    mutate(
      comparison = str_remove(comparison_full, "-Control"),
      p.signif = case_when(
        `p adj` < 0.001 ~ "***",
        `p adj` < 0.01 ~ "**",
        `p adj` < 0.05 ~ "*",
        TRUE ~ "ns"
      )
    )
  return(tukey_res)
}

# create plot
create_plot <- function(data_suffix, colors) {
  # tidy data
  plot_data <- speedTail %>%
    dplyr::select(ends_with(data_suffix)) %>%
    rename_with(~ gsub(paste0(data_suffix, "$"), "", .)) %>%
    mutate(
      group_treatment = factor(group_treatment, levels = c("Control", "70nM", "140nM", "600nM")),
      replicate = as.factor(replicate)
    ) %>%
    drop_na()
  
  # statistics
  stats_df <- get_stats(plot_data)
  
  # y positions for bars
  data_max <- max(plot_data$length, na.rm = TRUE)
  # y_positions <- c(data_max + 5, data_max + 10, data_max + 15)
  y_positions <- c(110, 117, 124) 
  
  # base plot
  p <- ggplot(plot_data, aes(
    x = group_treatment,
    y = length,
    col = group_treatment,
    fill = group_treatment
  )) +
    scale_y_continuous(
      limits = c(0, 130),
      breaks = c(0, 25, 50, 75, 100), 
      trans = "reverse"
    ) +
    geom_boxplot(aes(group = group_treatment, color = group_treatment), 
                 alpha = 0.3, fill = NA, linewidth = 0.6, outlier.shape = NA) +
    ggbeeswarm::geom_quasirandom(
      aes(shape = replicate), # without ==> 3 bars
      size = 3,
      width = 0.33,
      color = "black",
      alpha = 1,
      stroke = 0.8
    ) +
    scale_color_manual(values = colors) +
    scale_fill_manual(values = colors) +
    scale_shape_manual(values = c(21, 22, 23)) +
    scale_x_discrete(position = "bottom") +
    labs(x = "", y = "% tail regression") +
    custom_theme()
  
  # Add significance bars
  if ("70nM" %in% stats_df$comparison) {
    y1 <- y_positions[1]
    p <- p +
      annotate("segment", x = 1, xend = 2, y = y1, yend = y1, color = "black", linewidth = 0.5) +
      annotate("segment", x = 1, xend = 1, y = y1, yend = y1 - 2, color = "black", linewidth = 0.5) +
      annotate("segment", x = 2, xend = 2, y = y1, yend = y1 - 2, color = "black", linewidth = 0.5) +
      annotate("text", x = 1.5, y = y1 + 1, label = stats_df$p.signif[stats_df$comparison == "70nM"], size = 10, vjust = 0)
  }
  
  if ("140nM" %in% stats_df$comparison) {
    y2 <- y_positions[2]
    p <- p +
      annotate("segment", x = 1, xend = 3, y = y2, yend = y2, color = "black", linewidth = 0.5) +
      annotate("segment", x = 1, xend = 1, y = y2, yend = y2 - 2, color = "black", linewidth = 0.5) +
      annotate("segment", x = 3, xend = 3, y = y2, yend = y2 - 2, color = "black", linewidth = 0.5) +
      annotate("text", x = 2, y = y2 + 1, label = stats_df$p.signif[stats_df$comparison == "140nM"], size = 10, vjust = 0)
  }
  
  if ("600nM" %in% stats_df$comparison) {
    y3 <- y_positions[3]
    p <- p +
      annotate("segment", x = 1, xend = 4, y = y3, yend = y3, color = "black", linewidth = 0.5) +
      annotate("segment", x = 1, xend = 1, y = y3, yend = y3 - 2, color = "black", linewidth = 0.5) +
      annotate("segment", x = 4, xend = 4, y = y3, yend = y3 - 2, color = "black", linewidth = 0.5) +
      annotate("text", x = 2.5, y = y3 + 1, label = stats_df$p.signif[stats_df$comparison == "600nM"], size = 10, vjust = 0)
  }
  
  return(p)
}


# Create both plots with corrected scale_shape_manual
a <- create_plot("_a", custom_colors_T4) +
  scale_shape_manual(values = c("1" = 21, "2" = 22, "3" = 23), labels = c("1","2","3")) +
  geom_text(data = n_a,
            aes(x = group_treatment, y = y, label = label),
            inherit.aes = FALSE, size = 7, vjust = 0)

d <- create_plot("_d", custom_colors_T3) +
  scale_shape_manual(values = c("1" = 21, "2" = 22, "3" = 23), labels = c("1","2","3")) +
  geom_text(data = n_d,
            aes(x = group_treatment, y = y, label = label),
            inherit.aes = FALSE, size = 7, vjust = 0)



# Combine plots with legend settings
plot_T4_T3 <- a + d &
  theme(axis.title = element_text(size=22),
        axis.text = element_text(size=18),
        legend.position = c(0.95, 0.9),
        legend.justification = c(1, 0),
        legend.direction = "horizontal",
        legend.title = element_text(size = 10),
        legend.text = element_text(size = 9),
        legend.background = element_rect(fill = "white", color = "black", linewidth = 0.3)
  ) &
  guides(
    color = "none",
    fill = "none",
    shape = guide_legend(
      title = "Replicate",
      override.aes = list(size = 3, color = "black", fill = "white"),
      nrow = 1
    )
  )

plot_T4_T3

# saving 
# ggsave("ggsadv.pdf", plot = plot_T4_T3, device = cairo_pdf, width = 8.4167, height = 4,   units = "in", dpi = 300, family = "Helvetica")
# 
cowplot::save_plot(plot = plot_T4_T3,
                   base_height = 4,
                   base_asp = 4/1.9,
                   file = paste0(file_path, 'plot_T4_T3a.pdf', sep = ''))

# 
cowplot::save_plot(plot = plot_T4_T3,
                   base_height = 8,
                   base_asp = 1.9,
                   file = paste0(file_path, 'plot_T4_T3b.pdf', sep = ''),
                   limitsize = FALSE)


width_in <- 40 
aspect_ratio <- 3/4   
height_in <- width_in * aspect_ratio

width_mm <- 4*width_in / 25.4
height_mm <- 4*height_in / 25.4


CairoPDF(file.path(file_path,  "plot_T4_T3_00.pdf"), width = width_mm, height = height_mm)
print(plot_T4_T3)
dev.off()


# Using aspect ratio instead of explicit dimensions
cowplot::save_plot(
  plot = plot_T4_T3,
  base_height = height_in,  # or any base height
  base_asp = width_in / height_in,  # width:height ratio
  file = file.path(file_path, "plot_T4_T3_1.pdf")
)

cowplot::save_plot(plot = plot_T4_T3,
                   base_height = 0.9*3.71,
                   base_asp = 0.9*1.618,
                   file = file.path(file_path,'plot_T4_T3_2.pdf'))


cowplot::save_plot(plot = plot_T4_T3,
                   base_height = 1.9*3.71,
                   base_asp = 0.9*1.618,
                   file = file.path(file_path,'fig1I_nkx2.1-mut_thr-reporter_2.pdf'))

```

## panels 8 and 24 hph supplementary

```{r}
#| fig-width: 12
#| fig-height: 7
#| out-width: 100%
#| 
b <- create_plot("_b", custom_colors_T4) +
  scale_shape_manual(values = c("1" = 21, "2" = 22, "3" = 23),
                     labels = c("1","2","3")) +
  geom_text(data = n_b,
            aes(x = group_treatment, y = y, label = label),
            inherit.aes = FALSE, size = 4, vjust = 0)

c <- create_plot("_c", custom_colors_T4) +
  scale_shape_manual(values = c("1" = 21, "2" = 22, "3" = 23),
                     labels = c("1","2","3")) +
  geom_text(data = n_c,
            aes(x = group_treatment, y = y, label = label),
            inherit.aes = FALSE, size = 4, vjust = 0)


plot_T4_extra_timepoints <- b + c &
  theme(axis.title = element_text(size=22),
        axis.text = element_text(size=18),
        legend.position = c(0.95, 0.9),
        legend.justification = c(1, 0),
        legend.direction = "horizontal",
        legend.title = element_text(size = 10),
        legend.text = element_text(size = 9),
        legend.background = element_rect(fill = "white", color = "black", linewidth = 0.3)
  ) &
  guides(
    color = "none",
    fill = "none",
    shape = guide_legend(
      title = "Replicate",
      override.aes = list(size = 3, color = "black", fill = "white"),
      nrow = 1
    )
  )

plot_T4_extra_timepoints

## --- Save  ---

cowplot::save_plot(plot = plot_T4_extra_timepoints,
                   base_height = 4,
                   base_asp = 4/1.9,
                   file = file.path(file_path, "plot_T4_extra_timepoints_a.pdf"))

cowplot::save_plot(plot = plot_T4_extra_timepoints,
                   base_height = 8,
                   base_asp = 1.9,
                   file = file.path(file_path, "plot_T4_extra_timepoints_b.pdf"),
                   limitsize = FALSE)

width_in <- 40
aspect_ratio <- 3/4
height_in <- width_in * aspect_ratio

CairoPDF(file.path(file_path, "plot_T4_extra_timepoints_00.pdf"),
         width = width_in, height = height_in)
print(plot_T4_extra_timepoints)
dev.off()

cowplot::save_plot(
  plot = plot_T4_extra_timepoints,
  base_height = height_in,
  base_asp = width_in / height_in,
  file = file.path(file_path, "plot_T4_extra_timepoints_1.pdf")
)

cowplot::save_plot(plot = plot_T4_extra_timepoints,
                   base_height = 0.9*3.71,
                   base_asp = 0.9*1.618,
                   file = file.path(file_path, "plot_T4_extra_timepoints_2.pdf"))

cowplot::save_plot(plot = plot_T4_extra_timepoints,
                   base_height = 1.9*3.71,
                   base_asp = 0.9*1.618,
                   file = file.path(file_path, "fig1I_extra_timepoints.pdf"))

```

## extra: trying different layout

```{r}
# # _____________________________________________________________________
# # great now the plot
# # __________________________________________________________________________
# 
# custom_colors_T4 <- c("Control" = "#bdd7e7", "70nM" = "#6baed6", "140nM" = "#2171b5", "600nM" = "#1a56a6")
# custom_colors_T3 <- c("Control" = "#e6d7ef", "70nM" = "#c9a8e0", "140nM" = "#a579d1", "600nM" = "#7b52b5")
# 
# custom_shapes <- c("1" = 0, "2" = 1, "3" = 2, "4" = 19)  # Example shapes for replicates
# custom_shapes <- c("1" = 16, "2" = 17, "3" = 18, "4" = 19)  # Example shapes for replicates
# 
# a =speedTail %>%
#   dplyr::select(ends_with("_a")) |>
#   rename_with(~ gsub("_a$", "", .)) |>
#   mutate(
#     group_treatment = factor(group_treatment, levels = c("Control", "70nM", "140nM", "600nM")),
#     replicate = as.factor(replicate)
#   ) |>
#   drop_na() |>
#   ggplot(aes(
#     x = group_treatment,
#     y = length,
#     col = group_treatment, # Map color for the stroke, which will be overridden
#     fill = group_treatment, # Map fill to group_treatment for custom colors
#     shape = replicate
#   )) +
#     # ylim(0,130) +
#       scale_y_reverse(limits=c(130,0), breaks = c(0, 25, 50, 75, 100)) +
# 
#   geom_boxplot(aes(group = group_treatment, color = group_treatment), alpha = 0.3, fill = NA, size = 0.6, outlier.shape = NA) +
#   ggbeeswarm::geom_quasirandom(
#     size = 2.5,
#     width = 0.33,
#     color = "black", # Set stroke color
#     alpha = 1,
#     stroke = 0.4 # Adjust the thickness of the stroke
#   ) +
#   labs(x = "", y = "% tail regression") +
#   scale_color_manual(values = custom_colors_T4) + # Assign custom colors to fill
#   scale_fill_manual(values = custom_colors_T4) + # Assign custom colors to fill
#   scale_shape_manual(values = c(21, 22, 23))   # Assign shapes 21, 22, and 23 to different replicates
# 
# b= speedTail %>%
#   dplyr::select(ends_with("_d")) |>
#   rename_with(~ gsub("_d$", "", .)) |>
#   mutate(
#     group_treatment = factor(group_treatment, levels = c("Control", "70nM", "140nM", "600nM")),
#     replicate = as.factor(replicate)
#   ) |>
#   drop_na() |>
#   ggplot(aes(
#     x = group_treatment,
#     y = length,
#     col = group_treatment, # Map color for the stroke, which will be overridden
#     fill = group_treatment, # Map fill to group_treatment for custom colors
#     shape = replicate
#   )) +
#   geom_boxplot(aes(group = group_treatment, color = group_treatment), alpha = 0.3, fill = NA, size = 0.6, outlier.shape = NA) +
#   ggbeeswarm::geom_quasirandom(
#     size = 2.5,
#     width = 0.33,
#     color = "black", # Set stroke color
#     alpha = 1,
#     stroke = 0.3 # Adjust the thickness of the stroke
#   ) +
#   # ylim(0,130) +
#   # scale_y_reverse(limits=c(130,0), expand=c(0,0)) +
#     scale_y_reverse(limits=c(130,0), breaks = c(0, 25, 50, 75, 100)) +
# 
#   labs(x = "", y = "% tail regression") +
#   
#   scale_color_manual(values = custom_colors_T3) + # Assign custom colors to fill
#   scale_fill_manual(values = custom_colors_T3) + # Assign custom colors to fill
#   scale_shape_manual(values = c(21, 22, 23))  # Assign shapes 21, 22, and 23 to different replicates
#   # geom_beeswarm(aes(color = factor(group_treatment)), dodge.width = 0.5, stroke = 0.7, alpha = 0.5, size = 4) 
# 
# # a+b & theme(axis.title = element_text(size=22),
# #            axis.text = element_text(size=18),
# #            legend.position = "none") 
# 
# plota= a+b & theme(legend.position = "none") 
# plota

```
